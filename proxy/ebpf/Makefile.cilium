# Xray Proxy eBPF with Cilium ebpf-go

TARGET_ARCH ?= x86_64
GO ?= go

all: generate

# ä½¿ç”¨ bpf2go ç”Ÿæˆ Go ç»‘å®š
generate:
	@echo "ğŸ”¨ ä½¿ç”¨ Cilium bpf2go ç”Ÿæˆ eBPF Go ç»‘å®š..."
	$(GO) generate ./proxy_integration_cilium.go
	@echo "âœ… eBPF Go ç»‘å®šç”ŸæˆæˆåŠŸ"

clean:
	rm -f proxy_accelerator_bpfel.go proxy_accelerator_bpfeb.go
	rm -f proxy_accelerator_bpfel.o proxy_accelerator_bpfeb.o
	@echo "ğŸ§¹ æ¸…ç†å®Œæˆ"

install: generate
	@echo "ğŸ“¦ Cilium eBPF ç¨‹åºå·²å‡†å¤‡å°±ç»ª"
	@echo "âœ… æ— éœ€æ‰‹åŠ¨å®‰è£… - Cilium ebpf-go ä¼šè‡ªåŠ¨å¤„ç†ç¨‹åºåŠ è½½"

status:
	@echo "ğŸ“Š Cilium eBPF ç¨‹åºçŠ¶æ€:"
	@echo "   æ£€æŸ¥ç”Ÿæˆçš„ Go æ–‡ä»¶:"
	@ls -la proxy_accelerator_bpf*.go 2>/dev/null || echo "   éœ€è¦è¿è¡Œ 'make generate'"

help:
	@echo "Cilium eBPF Proxy åŠ é€Ÿå™¨æ„å»ºå¸®åŠ©:"
	@echo "  make generate  - ä½¿ç”¨ bpf2go ç”Ÿæˆ Go ç»‘å®š"
	@echo "  make clean     - æ¸…ç†ç”Ÿæˆçš„æ–‡ä»¶"
	@echo "  make install   - å‡†å¤‡å®‰è£…ï¼ˆå®é™…åŠ è½½ç”± Go ä»£ç å¤„ç†ï¼‰"
	@echo "  make status    - æ˜¾ç¤ºçŠ¶æ€"

.PHONY: all generate clean install status help